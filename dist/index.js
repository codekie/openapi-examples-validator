(()=>{var e={331:(e,t,r)=>{const a=r(200),n={byte:{min:new a("-128"),max:new a("127")},int32:{min:new a("-2147483648"),max:new a("2147483647")},int64:{min:new a("-9223372036854775808"),max:new a("9223372036854775807")},float:{min:new a(2).pow(128).negated(),max:new a(2).pow(128)},double:{min:new a(2).pow(1024).negated(),max:new a(2).pow(1024)}};e.exports=n},466:(e,t,r)=>{const a=r(331);e.exports={int32:function(e){return Number.isInteger(+e)&&a.int32.max.greaterThanOrEqualTo(e)&&a.int32.min.lessThanOrEqualTo(e)},int64:function(e){return Number.isInteger(+e)&&a.int64.max.greaterThanOrEqualTo(e)&&a.int64.min.lessThanOrEqualTo(e)},float:function(e){return a.float.max.greaterThanOrEqualTo(e)&&a.float.min.lessThanOrEqualTo(e)},double:function(e){return a.double.max.greaterThanOrEqualTo(e)&&a.double.min.lessThanOrEqualTo(e)},byte:function(e){const t=e.length;if(!t||t%4!=0||/[^A-Z0-9+\/=]/i.test(e))return!1;const r=e.indexOf("=");return-1===r||r===t-1||r===t-2&&"="===e[t-1]}}},114:(e,t,r)=>{const a=r(981),{ENOENT:n}=r(373).code,o={jsENOENT:n.code,jsonPathNotFound:"JsonPathNotFound",errorAndErrorsMutuallyExclusive:"ErrorErrorsMutuallyExclusive",parseError:"ParseError",validation:"Validation"};class s{static create(e){const{code:t,message:r,path:n,cause:i}=e,c=t||e.type||o.validation,l={message:r};return o.validation===c||o.errorAndErrorsMutuallyExclusive===c?a(l,e):(n&&a(l,{params:{path:n}}),i&&a(l,i)),new s(c,l)}constructor(e,t={}){Object.assign(this,{type:e,...t})}}e.exports={ApplicationError:s,ErrorType:o}},99:e=>{e.exports={parent:"parent",parentProperty:"parentProperty",path:"path",pointer:"pointer",value:"value"}},951:(e,t,r)=>{const a=r(565),n=r(291),o=/^3\./;e.exports={getImplementation:function(e){return"string"==typeof e.swagger?a:e.openapi&&e.openapi.match(o)?n:null}}},251:(e,t,r)=>{const{JSONPath:a}=r(166),n=r(99),o=["$..application/json.schema",'$..schema..[?(@.properties && (@property === "schema" || @property === "items" || @.type === "object"))]'],s=["oneOf","allOf","anyOf","not"];function i(e){return t=>{const r=JSON.stringify(t);s.some((e=>r.includes(`"${e}"`)))?console.warn(`"additionalProperties" flag not set for ${e} because it contains JSON-schema combiner keywords.`):t.additionalProperties=!1}}function c(e,t,r=n.path,o){return a({json:e,path:t,flatten:!0,resultType:r,callback:o})}e.exports={setNoAdditionalProperties:function(e,t=[],r=i){const a=new Set;o.forEach((t=>{c(e,t).forEach((e=>{s.some((t=>e.includes(`['${t}']`)))?console.warn(`"additionalProperties" flag not set for ${e} because it contains JSON-schema combiner keywords.`):a.add(e)}))})),function(e,t,r){r.forEach((r=>{c(e,r).forEach((e=>{for(const r of t)r.startsWith(e)&&t.delete(r)}))}))}(e,a,t);for(const t of a)c(e,t,n.value,r(t))}}},565:(e,t,r)=>{const{JSONPath:a}=r(166),{setNoAdditionalProperties:n}=r(251),o=r(548);function s(){return["$..examples.application/json"]}e.exports={buildValidationMap:function(e){return e.reduce(((e,t)=>{const r=function(e){const t=a.toPathArray(e).slice(),r=t.lastIndexOf("examples");return t.splice(r,t.length-r,"schema"),a.toPathString(t)}(t);return e[r]=(e[r]||new Set).add(t),e}),{})},escapeExampleName:function(e){return e},getJsonPathsToExamples:s,prepare:function(e,{noAdditionalProperties:t}={}){const r=o(e);return t&&n(r,["$..examples.application/json"]),r},unescapeExampleNames:function(e){return e}}},291:(e,t,r)=>{const{JSONPath:a}=r(166),n=r(548),{ApplicationError:o,ErrorType:s}=r(114),{setNoAdditionalProperties:i}=r(251),c="single";function l(){return["$..responses..content.application/json.example","$..responses..content.application/json.examples.*.value","$..parameters..example","$..parameters..examples.*.value","$..requestBody.content.application/json.example","$..requestBody.content.application/json.examples.*.value"]}e.exports={buildValidationMap:function(e){const t=new Map;return e.reduce(((e,r)=>{const{pathSchemaAsArray:n,exampleType:i}=function(e){const t=a.toPathArray(e).slice(),r=t.lastIndexOf("example"),n=r>-1?c:"multi",o=n===c?r:t.lastIndexOf("examples");return t.splice(o,t.length-o,"schema"),{exampleType:n,pathSchemaAsArray:t}}(r),l=a.toPathString(n),p=t.get(l);return p&&p!==i&&function(e){const t=e.slice(0,e.length-1);throw o.create({type:s.errorAndErrorsMutuallyExclusive,message:'Properties "error" and "errors" are mutually exclusive',params:{pathContext:a.toPointer(t)}})}(n),t.set(l,i),e[l]=(e[l]||new Set).add(r),e}),{})},escapeExampleName:function(e){return e.replace(/\['examples'\]\['(.*)\]\['value'\]$/,"['examples']['`$1]['value']")},getJsonPathsToExamples:l,prepare:function(e,{noAdditionalProperties:t}={}){const r=n(e);return t&&i(r,["$..responses..content.application/json.example","$..responses..content.application/json.examples.*.value","$..parameters..example","$..parameters..examples.*.value","$..requestBody.content.application/json.example","$..requestBody.content.application/json.examples.*.value"]),r},unescapeExampleNames:function(e){return e&&e.replace(/\/examples\/`(.*)\/value$/,"/examples/$1/value")}}},442:(e,t,r)=>{const a=r(981),n=r(760),o=r(574),s=r(147),i=r(17),c=r(230),l=r(66),{JSONPath:p}=r(166),u=r(432),{createError:m}=r(373).custom,d=r(99),{getValidatorFactory:h,compileValidate:f}=r(924),x=r(951),{ApplicationError:y,ErrorType:g}=r(114),{createValidationResponse:E,dereferenceJsonSchema:P}=r(754),w=Symbol("internal"),v="schemasWithExamples",b=["yaml","yml"],j=m(g.jsonPathNotFound);async function F(e,{noAdditionalProperties:t,ignoreFormats:r}={}){const a=x.getImplementation(e);e=await u.dereference(e),e=a.prepare(e,{noAdditionalProperties:t});let n=a.getJsonPathsToExamples().reduce(((t,r)=>t.concat(function(e,t){return p({json:e,path:t,resultType:d.path})}(e,r))),[]).map(a.escapeExampleName);return function({impl:e},t,r,{ignoreFormats:a}){const n=$(),o={valid:!0,statistics:n,errors:[]},s=q(r,{ignoreFormats:a});let i;try{i=e.buildValidationMap(t)}catch(e){if(!(e instanceof y))throw e;return o.valid=!1,o.errors.push(e),o}return Object.keys(i).forEach((e=>{!function({openapiSpec:e,createValidator:t,pathSchema:r,validationMap:a,statistics:n,validationResult:o}){const s=o.errors;a[r].forEach((a=>{const i=N(a,e),c=J(r,e,!0),l=A({createValidator:t,schema:c,example:i,statistics:n}).map((e=>(e.examplePath=p.toPointer(p.toPathArray(a)),e)));l.length&&(o.valid=!1,s.splice(s.length-1,0,...l))}))}({openapiSpec:r,createValidator:s,pathSchema:e,validationMap:i,statistics:n,validationResult:o})})),o.errors.forEach((t=>{t.examplePath=e.unescapeExampleNames(t.examplePath)})),o}({impl:a},n,e,{ignoreFormats:r})}async function O(e){const t=function(e){const t=e.split(".").pop();return b.includes(t)}(e);let r;if(t)try{r=l.parse(s.readFileSync(e,"utf-8"))}catch(e){const{name:t,message:r}=e;throw new y(g.parseError,{message:`${t}: ${r}`})}else r=JSON.parse(s.readFileSync(e,"utf-8"));return await P(e,r)}function S(e){const t=$(),r=e(t);return E({errors:r,statistics:t})}function T(e,t,r,{cwdToMappingFile:a=!1,dirPathMapExternalExamples:c,ignoreFormats:l}){return o(Object.entries(t),(([t,p])=>{let u=null;try{u=J(t,e)}catch(e){return y.create(e)}return o(n([p]),(t=>{let n=null;try{const e=a?i.join(c,t):t;n=JSON.parse(s.readFileSync(e,"utf-8"))}catch(e){return[y.create(e)]}return A({createValidator:q(e,{ignoreFormats:l}),schema:u,example:n,statistics:r,filePathExample:t})}))}))}function $(){const e={[w]:{[v]:new Set},examplesTotal:0,examplesWithoutSchema:0};return Object.defineProperty(e,v,{enumerable:!0,get:()=>e[w].schemasWithExamples.size}),e}function N(e,t){return p({json:t,path:e,flatten:!0,wrap:!1,resultType:d.value})}function A({createValidator:e,schema:t,example:r,statistics:a,filePathExample:n}){const o=[];if(a.examplesTotal++,!t)return a.examplesWithoutSchema++,o;a[w].schemasWithExamples.add(t);const s=f(e(),t);return s(r)?o:o.concat(...s.errors.map(y.create)).map((e=>n?(e.exampleFilePath=n,e):e))}function q(e,{ignoreFormats:t}){return h(e,{schemaId:"auto",discriminator:!0,strict:!1,allErrors:!0,formats:t&&t.reduce(((e,t)=>(e[t]=()=>!0,e)),{})})}function J(e,t,r=!1){const a=N(e,t);if(!r&&!a)throw new j(`Path to schema can't be found: '${e}'`,{params:{path:e}});return a}e.exports={default:F,validateFile:async function(e,{noAdditionalProperties:t,ignoreFormats:r}={}){let a=null;try{a=await O(e)}catch(e){return E({errors:[y.create(e)]})}return F(a,{noAdditionalProperties:t,ignoreFormats:r})},validateExample:async function(e,t,r,{noAdditionalProperties:a,ignoreFormats:n}={}){let o=null,i=null,c=null;try{o=JSON.parse(s.readFileSync(r,"utf-8")),c=await O(e),c=x.getImplementation(c).prepare(c,{noAdditionalProperties:a}),i=J(t,c)}catch(e){return E({errors:[y.create(e)]})}return S((e=>A({createValidator:q(c,{ignoreFormats:n}),schema:i,example:o,statistics:e,filePathExample:r})))},validateExamplesByMap:async function(e,t,{cwdToMappingFile:r,noAdditionalProperties:n,ignoreFormats:o}={}){let l=0;const p=c.sync(t,{nonull:!0});let u=[];for(let t of p){let a=null,c=null;try{a=JSON.parse(s.readFileSync(t,"utf-8")),c=await O(e),c=x.getImplementation(c).prepare(c,{noAdditionalProperties:n})}catch(e){u.push(E({errors:[y.create(e)]}));continue}l++,u.push(S((e=>T(c,a,e,{cwdToMappingFile:r,dirPathMapExternalExamples:i.dirname(t),ignoreFormats:o}).map((e=>Object.assign(e,{mapFilePath:t}))))))}return a(u.reduce(((e,t)=>{return e?(a=t,E({errors:(r=e).errors.concat(a.errors),statistics:Object.entries(r.statistics).reduce(((e,[t,n])=>v===t?([r,a].forEach((t=>{const r=t.statistics[w].schemasWithExamples.values();for(let t of r)e[w].schemasWithExamples.add(t)})),e):(e[t]=n+a.statistics[t],e)),$())})):t;var r,a}),null),{statistics:{matchingFilePathsMapping:l}})}}},754:(e,t,r)=>{const a=r(17),n=r(432);e.exports={createValidationResponse:function({errors:e,statistics:t={}}){return{valid:!e.length,statistics:t,errors:e}},dereferenceJsonSchema:async function(e,t){const r=process.cwd();process.chdir(a.dirname(e));const o=await n.dereference(t);return process.chdir(r),o}}},924:(e,t,r)=>{const{JSONPath:a}=r(166),n=r(125),o=r(643),s=r(466),i="$..$ref",c="https://www.npmjs.com/package/openapi-examples-validator/defs.json";e.exports={getValidatorFactory:function(e,t){const r=function(e){const t={$id:c};return a({path:i,json:e,callback(r){if(!r.startsWith("#"))return;const a=r.substring(1),o=n.get(e,a);n.set(t,a,o)}}),t}(e);return()=>{const e=new o(t);return function(e){const t=new RegExp("^(-?(?:[1-9][0-9]*)?[0-9]{4})-(1[0-2]|0[1-9])-(3[01]|0[1-9]|[12][0-9])T(2[0-3]|[01][0-9]):([0-5][0-9]):([0-5][0-9])(.[0-9]+)?Z$");e.addFormat("int32",{type:"number",validate:s.int32}),e.addFormat("int64",{type:"string",validate:s.int64}),e.addFormat("float",{type:"number",validate:s.float}),e.addFormat("double",{type:"number",validate:s.double}),e.addFormat("byte",{type:"string",validate:s.byte}),e.addFormat("date-time",{validate:e=>t.test(e)})}(e),e.addSchema(r),e}},compileValidate:function(e,t){const r=function(e,t){const r=Object.assign({},e);return r.$id="https://www.npmjs.com/package/openapi-examples-validator/schema.json",r}(t);let n;a({path:i,json:r,callback(e,t,r){e.startsWith("#")&&(r.parent[r.parentProperty]=`${c}${e}`)}});try{n=e.compile(r)}catch(e){n=()=>{},n.errors=[e]}return n}}},643:e=>{"use strict";e.exports=require("ajv-draft-04")},200:e=>{"use strict";e.exports=require("decimal.js")},373:e=>{"use strict";e.exports=require("errno")},230:e=>{"use strict";e.exports=require("glob")},125:e=>{"use strict";e.exports=require("json-pointer")},432:e=>{"use strict";e.exports=require("json-schema-ref-parser")},166:e=>{"use strict";e.exports=require("jsonpath-plus")},548:e=>{"use strict";e.exports=require("lodash.clonedeep")},574:e=>{"use strict";e.exports=require("lodash.flatmap")},760:e=>{"use strict";e.exports=require("lodash.flatten")},981:e=>{"use strict";e.exports=require("lodash.merge")},66:e=>{"use strict";e.exports=require("yaml")},147:e=>{"use strict";e.exports=require("fs")},17:e=>{"use strict";e.exports=require("path")}},t={},r=function r(a){var n=t[a];if(void 0!==n)return n.exports;var o=t[a]={exports:{}};return e[a](o,o.exports,r),o.exports}(442);module.exports=r})();
//# sourceMappingURL=index.js.map